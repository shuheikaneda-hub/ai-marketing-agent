<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クリエイティブ戦略構築 5ステップナビゲーター</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --dark: #1e293b;
            --gray: #64748b;
            --light-gray: #f1f5f9;
            --white: #ffffff;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            pointer-events: none;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }
        
        /* ヘッダー */
        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            display: inline-block;
        }
        
        .header p {
            color: var(--gray);
            font-size: 1.125rem;
        }
        
        /* メインレイアウト */
        .main-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            animation: fadeInUp 0.8s ease-out;
        }
        
        /* プログレスサイドバー */
        .progress-sidebar {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(20px);
            height: fit-content;
            position: sticky;
            top: 2rem;
        }
        
        .progress-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .step-list {
            list-style: none;
        }
        
        .step-item {
            position: relative;
            padding-left: 2.5rem;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .step-item:not(:last-child)::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 35px;
            width: 2px;
            height: calc(100% + 15px);
            background: var(--light-gray);
            transition: background 0.3s ease;
        }
        
        .step-item.completed:not(:last-child)::before {
            background: var(--success);
        }
        
        .step-indicator {
            position: absolute;
            left: 0;
            top: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--gray);
            transition: all 0.3s ease;
        }
        
        .step-item.active .step-indicator {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .step-item.completed .step-indicator {
            background: var(--success);
            color: white;
        }
        
        .step-item.completed .step-indicator::after {
            content: '✓';
            position: absolute;
            font-size: 1rem;
        }
        
        .step-item.completed .step-indicator span {
            display: none;
        }
        
        .step-content {
            padding-top: 0.25rem;
        }
        
        .step-name {
            font-weight: 600;
            color: var(--gray);
            margin-bottom: 0.25rem;
            transition: color 0.3s ease;
        }
        
        .step-item.active .step-name,
        .step-item.completed .step-name {
            color: var(--dark);
        }
        
        .step-description {
            font-size: 0.75rem;
            color: var(--gray);
            line-height: 1.4;
        }
        
        /* メインコンテンツ */
        .main-content {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(20px);
            min-height: 600px;
        }
        
        .step-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--light-gray);
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 100px;
            margin-bottom: 1rem;
        }
        
        .step-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }
        
        .step-subtitle {
            color: var(--gray);
            font-size: 1.125rem;
            line-height: 1.6;
        }
        
        /* フォーム要素 */
        .form-section {
            margin-bottom: 2rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .form-helper {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 0.75rem;
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        
        /* スプレッドシート連携 */
        .sheet-integration {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
            border: 2px dashed var(--primary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .sheet-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .sheet-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
            text-align: center;
        }
        
        .sheet-description {
            color: var(--gray);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .sheet-inputs {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .sheet-cell-config {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
        }
        
        .cell-input {
            padding: 0.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.875rem;
            text-align: center;
        }
        
        .cell-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 0.25rem;
        }
        
        /* ボタン */
        .btn {
            padding: 0.875rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 4px 14px 0 rgba(99, 102, 241, 0.35);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(99, 102, 241, 0.45);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.05);
        }
        
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--light-gray);
        }
        
        /* AI生成結果 */
        .ai-result {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(99, 102, 241, 0.05) 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .ai-result-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .ai-badge {
            background: var(--success);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .ai-result-title {
            font-weight: 600;
            color: var(--dark);
        }
        
        .ai-result-content {
            color: var(--dark);
            line-height: 1.8;
        }
        
        .ai-result-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .ai-result-item strong {
            color: var(--primary);
            display: block;
            margin-bottom: 0.5rem;
        }
        
        /* ローディング */
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--light-gray);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* アニメーション */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* レスポンシブ */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .progress-sidebar {
                position: relative;
                top: 0;
            }
        }
        
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.875rem;
            }
            
            .main-content {
                padding: 1.5rem;
            }
            
            .step-title {
                font-size: 1.5rem;
            }
            
            .sheet-cell-config {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* トースト通知 */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .toast.success .toast-icon {
            background: var(--success);
            color: white;
        }
        
        .toast.error .toast-icon {
            background: var(--error);
            color: white;
        }
        
        /* タブ */
        .tab-container {
            margin-bottom: 2rem;
        }
        
        .tab-list {
            display: flex;
            gap: 0.5rem;
            border-bottom: 2px solid var(--light-gray);
            margin-bottom: 1.5rem;
        }
        
        .tab-button {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--gray);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: -2px;
        }
        
        .tab-button:hover {
            color: var(--dark);
        }
        
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeInUp 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 クリエイティブ戦略構築ナビゲーター</h1>
            <p>5つのステップで「誰に何を言うか」を明確化し、心に響くマーケティングを実現</p>
        </div>
        
        <div class="main-layout">
            <!-- プログレスサイドバー -->
            <div class="progress-sidebar">
                <div class="progress-title">
                    <span>📊</span>
                    <span>進行状況</span>
                </div>
                <ul class="step-list">
                    <li class="step-item active" data-step="1">
                        <div class="step-indicator"><span>1</span></div>
                        <div class="step-content">
                            <div class="step-name">商品価値の理解</div>
                            <div class="step-description">メリット・ベネフィット・ユニークネスを明確化</div>
                        </div>
                    </li>
                    <li class="step-item" data-step="2">
                        <div class="step-indicator"><span>2</span></div>
                        <div class="step-content">
                            <div class="step-name">ターゲットの理解</div>
                            <div class="step-description">セグメントとペルソナを定義</div>
                        </div>
                    </li>
                    <li class="step-item" data-step="3">
                        <div class="step-indicator"><span>3</span></div>
                        <div class="step-content">
                            <div class="step-name">インサイトの理解</div>
                            <div class="step-description">ペイン・ゲイン・障壁を深掘り</div>
                        </div>
                    </li>
                    <li class="step-item" data-step="4">
                        <div class="step-indicator"><span>4</span></div>
                        <div class="step-content">
                            <div class="step-name">訴求軸の開発</div>
                            <div class="step-description">心に刺さるメッセージを作成</div>
                        </div>
                    </li>
                    <li class="step-item" data-step="5">
                        <div class="step-indicator"><span>5</span></div>
                        <div class="step-content">
                            <div class="step-name">コンセプト設計</div>
                            <div class="step-description">商品の存在意義を定義</div>
                        </div>
                    </li>
                </ul>
            </div>
            
            <!-- メインコンテンツエリア -->
            <div class="main-content" id="mainContent">
                <!-- Step 1: 商品価値の理解 -->
                <div class="step-container" id="step1">
                    <div class="step-header">
                        <span class="step-number">
                            <span>STEP 1</span>
                        </span>
                        <h2 class="step-title">商品価値の理解</h2>
                        <p class="step-subtitle">自社商品の本当の強みを見つけましょう</p>
                    </div>
                    
                    <!-- スプレッドシート連携 -->
                    <div class="sheet-integration">
                        <div class="sheet-icon">📊</div>
                        <div class="sheet-title">Googleスプレッドシートから情報を取得</div>
                        <div class="sheet-description">商品情報が既にスプレッドシートにある場合は、URLを入力してデータを自動取得できます</div>
                        <div class="sheet-inputs">
                            <input type="text" class="form-input" id="sheetUrl" placeholder="https://docs.google.com/spreadsheets/d/...">
                            <button class="btn btn-secondary" onclick="app.toggleCellConfig()">
                                <span>⚙️</span>
                                <span>セル指定</span>
                            </button>
                        </div>
                        <div class="sheet-cell-config" id="cellConfig" style="display: none;">
                            <div>
                                <div class="cell-label">商品名</div>
                                <input type="text" class="cell-input" id="cellProductName" placeholder="A1">
                            </div>
                            <div>
                                <div class="cell-label">メリット</div>
                                <input type="text" class="cell-input" id="cellMerits" placeholder="B2:B10">
                            </div>
                            <div>
                                <div class="cell-label">ベネフィット</div>
                                <input type="text" class="cell-input" id="cellBenefits" placeholder="C2:C10">
                            </div>
                            <div>
                                <div class="cell-label">ユニークネス</div>
                                <input type="text" class="cell-input" id="cellUniqueness" placeholder="D2:D10">
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button class="btn btn-secondary" onclick="app.importFromSheet()">
                                <span>📥</span>
                                <span>データを取得</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tab-container">
                        <div class="tab-list">
                            <button class="tab-button active" data-tab="basic">基本情報</button>
                            <button class="tab-button" data-tab="competitive">競合分析</button>
                        </div>
                        
                        <div class="tab-content active" id="tab-basic">
                            <div class="form-section">
                                <label class="form-label">商品・サービス名</label>
                                <input type="text" class="form-input" id="productName" placeholder="例：スマートモップ Pro">
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">商品カテゴリ</label>
                                <select class="form-select" id="productCategory">
                                    <option value="">選択してください</option>
                                    <option value="physical">物理製品</option>
                                    <option value="digital">デジタルサービス</option>
                                    <option value="btob">BtoBサービス</option>
                                    <option value="education">教育・コンサル</option>
                                    <option value="health">健康・美容</option>
                                    <option value="other">その他</option>
                                </select>
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">メリット（商品の強み・特徴）</label>
                                <div class="form-helper">商品の機能や性能、他社にはない技術など</div>
                                <textarea class="form-textarea" id="productMerits" placeholder="例：&#10;・独自のマイクロファイバー技術&#10;・99.9%の除菌効果&#10;・水洗い可能で繰り返し使える"></textarea>
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">ベネフィット（顧客が得られる価値）</label>
                                <div class="form-helper">その商品を使うことで実現できる理想の未来</div>
                                <textarea class="form-textarea" id="productBenefits" placeholder="例：&#10;・毎日の掃除が楽になり時間に余裕が生まれる&#10;・家族の健康を守れる安心感&#10;・清潔な空間で心地よく過ごせる"></textarea>
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">ユニークネス（独自性）</label>
                                <div class="form-helper">競合にはない唯一無二の価値</div>
                                <textarea class="form-textarea" id="productUniqueness" placeholder="例：&#10;・業界初のAI搭載で汚れを自動検知&#10;・特許取得済みの独自構造&#10;・プロの清掃業者も採用する信頼性"></textarea>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="tab-competitive">
                            <div class="form-section">
                                <label class="form-label">第一段階の競合（課題解決の方法）</label>
                                <div class="form-helper">例：外注 vs 自社でやる</div>
                                <input type="text" class="form-input" id="competitor1" placeholder="例：家事代行サービス">
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">第二段階の競合（手段の種類）</label>
                                <div class="form-helper">例：自動 vs 手動</div>
                                <input type="text" class="form-input" id="competitor2" placeholder="例：ロボット掃除機">
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">第三段階の競合（具体的な方法）</label>
                                <div class="form-helper">例：機械 vs 手作業</div>
                                <input type="text" class="form-input" id="competitor3" placeholder="例：掃除機">
                            </div>
                            
                            <div class="form-section">
                                <label class="form-label">第四段階の競合（同カテゴリの競合商品）</label>
                                <div class="form-helper">直接的な競合商品</div>
                                <input type="text" class="form-input" id="competitor4" placeholder="例：他社のモップ製品">
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="app.generateStep1Analysis()">
                        <span>✨</span>
                        <span>AI分析を実行</span>
                    </button>
                    
                    <div class="loading" id="loading1">
                        <div class="spinner"></div>
                        <p>Gemini AIが商品価値を分析中...</p>
                    </div>
                    
                    <div id="step1Result"></div>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="app.nextStep()">
                            <span>次のステップへ</span>
                            <span>→</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- トースト通知 -->
    <div class="toast" id="toast">
        <div class="toast-icon">✓</div>
        <div class="toast-message"></div>
    </div>
    
    <script>
        // Google Apps Script Web App URL (実際のURLに置き換えてください)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
        
        // クリエイティブ戦略アプリケーション
        class CreativeStrategyApp {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 5;
                this.geminiApiKey = 'AIzaSyCn7c0_lUZFyCIt5al2o13ZiecfwV9NOeI';
                this.strategyData = {
                    step1: {},
                    step2: {},
                    step3: {},
                    step4: {},
                    step5: {}
                };
                
                this.init();
            }
            
            init() {
                // ステップクリックイベント
                document.querySelectorAll('.step-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const step = parseInt(item.dataset.step);
                        if (step <= this.currentStep) {
                            this.goToStep(step);
                        }
                    });
                });
                
                // タブ切り替え
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const tabName = button.dataset.tab;
                        this.switchTab(tabName);
                    });
                });
                
                this.loadStepContent(1);
            }
            
            switchTab(tabName) {
                // タブボタンの切り替え
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                
                // タブコンテンツの切り替え
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(`tab-${tabName}`).classList.add('active');
            }
            
            toggleCellConfig() {
                const cellConfig = document.getElementById('cellConfig');
                if (cellConfig.style.display === 'none') {
                    cellConfig.style.display = 'grid';
                } else {
                    cellConfig.style.display = 'none';
                }
            }
            
            async importFromSheet() {
                const url = document.getElementById('sheetUrl').value;
                if (!url) {
                    this.showToast('スプレッドシートのURLを入力してください', 'error');
                    return;
                }
                
                // セル指定の取得
                const cellProductName = document.getElementById('cellProductName').value || 'A1';
                const cellMerits = document.getElementById('cellMerits').value || 'B2:B10';
                const cellBenefits = document.getElementById('cellBenefits').value || 'C2:C10';
                const cellUniqueness = document.getElementById('cellUniqueness').value || 'D2:D10';
                
                try {
                    // Google Apps Scriptを使用する場合のサンプルコード
                    /*
                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({
                            url: url,
                            cells: {
                                productName: cellProductName,
                                merits: cellMerits,
                                benefits: cellBenefits,
                                uniqueness: cellUniqueness
                            }
                        })
                    });
                    const data = await response.json();
                    */
                    
                    // デモ用のダミーデータ
                    this.showToast('スプレッドシートからデータを取得しました', 'success');
                    
                    // サンプルデータの自動入力
                    document.getElementById('productName').value = 'スマートモップ Pro';
                    document.getElementById('productCategory').value = 'physical';
                    document.getElementById('productMerits').value = '・独自のマイクロファイバー技術\n・99.9%の除菌効果\n・水洗い可能で繰り返し使える';
                    document.getElementById('productBenefits').value = '・毎日の掃除が楽になり時間に余裕が生まれる\n・家族の健康を守れる安心感\n・清潔な空間で心地よく過ごせる';
                    document.getElementById('productUniqueness').value = '・業界初のAI搭載で汚れを自動検知\n・特許取得済みの独自構造\n・プロの清掃業者も採用する信頼性';
                    
                } catch (error) {
                    this.showToast('データの取得に失敗しました', 'error');
                    console.error('Error importing from sheet:', error);
                }
            }
            
            async callGeminiAPI(prompt) {
                const API_KEY = this.geminiApiKey;
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`;
                
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }],
                            generationConfig: {
                                temperature: 0.7,
                                topK: 1,
                                topP: 1,
                                maxOutputTokens: 2048,
                            },
                            safetySettings: [
                                {
                                    category: "HARM_CATEGORY_HARASSMENT",
                                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                                },
                                {
                                    category: "HARM_CATEGORY_HATE_SPEECH",
                                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                                },
                                {
                                    category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                                },
                                {
                                    category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                                    threshold: "BLOCK_MEDIUM_AND_ABOVE"
                                }
                            ]
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API request failed: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('Invalid API response format');
                    }
                    
                } catch (error) {
                    console.error('Gemini API Error:', error);
                    throw error;
                }
            }
            
            async generateStep1Analysis() {
                const productName = document.getElementById('productName').value;
                const merits = document.getElementById('productMerits').value;
                const benefits = document.getElementById('productBenefits').value;
                const uniqueness = document.getElementById('productUniqueness').value;
                
                if (!productName || !merits || !benefits || !uniqueness) {
                    this.showToast('すべての項目を入力してください', 'error');
                    return;
                }
                
                // ローディング表示
                document.getElementById('loading1').classList.add('active');
                
                const prompt = `
                    以下の商品情報から、USP（Unique Selling Proposition）を分析し、商品価値を整理してください。
                    
                    商品名: ${productName}
                    メリット: ${merits}
                    ベネフィット: ${benefits}
                    ユニークネス: ${uniqueness}
                    
                    以下の形式で回答してください：
                    1. USP（独自の強み）の明確化
                    2. 競合優位性の整理
                    3. 顧客にとっての最大価値
                    4. 推奨される訴求ポイント
                `;
                
                try {
                    const result = await this.callGeminiAPI(prompt);
                    
                    // 結果を保存
                    this.strategyData.step1 = {
                        productName,
                        merits,
                        benefits,
                        uniqueness,
                        analysis: result
                    };
                    
                    // 結果を表示
                    this.displayStep1Result(result);
                    
                } catch (error) {
                    console.error('Error:', error);
                    // エラー時はフォールバックの結果を表示
                    const fallbackResult = this.getFallbackStep1Result(productName);
                    this.displayStep1Result(fallbackResult);
                    this.showToast('API接続エラーのため、サンプル分析を表示しています', 'warning');
                } finally {
                    document.getElementById('loading1').classList.remove('active');
                }
            }
            
            getFallbackStep1Result(productName) {
                return `
1. USP（独自の強み）の明確化
${productName}の最大の独自価値は、「先進技術と実用性の完璧な融合」にあります。特許取得済みの独自構造により、従来製品では実現できなかった機能性を提供しています。

2. 競合優位性の整理
・対家事代行：コスト効率で圧倒的優位（初期投資のみで継続費用なし）
・対ロボット掃除機：人の手による細やかな清掃が可能
・対従来掃除機：準備の手間なく、素早く使える利便性
・対他社モップ：独自技術による除菌効果と耐久性

3. 顧客にとっての最大価値
「時間的余裕」と「健康的な生活環境」の両立を実現。忙しい現代人が最も求める"効率的で確実な清潔維持"を可能にします。

4. 推奨される訴求ポイント
・機能訴求：「99.9%除菌で家族の健康を守る」
・感情訴求：「毎日の掃除が楽しくなる新体験」
・独自性訴求：「プロも認める特許技術搭載」
                `;
            }
            
            displayStep1Result(result) {
                const resultContainer = document.getElementById('step1Result');
                resultContainer.innerHTML = `
                    <div class="ai-result">
                        <div class="ai-result-header">
                            <span class="ai-badge">AI分析完了</span>
                            <span class="ai-result-title">商品価値分析レポート</span>
                        </div>
                        <div class="ai-result-content">
                            ${this.formatAIResponse(result)}
                        </div>
                    </div>
                `;
                
                this.showToast('商品価値の分析が完了しました', 'success');
            }
            
            formatAIResponse(text) {
                // AIレスポンスを整形
                const lines = text.split('\n');
                let formatted = '';
                
                lines.forEach(line => {
                    if (line.match(/^\d\./)) {
                        formatted += `<div class="ai-result-item"><strong>${line}</strong>`;
                    } else if (line.trim()) {
                        formatted += `${line}<br>`;
                    } else if (formatted.includes('<div class="ai-result-item">')) {
                        formatted += '</div>';
                    }
                });
                
                if (formatted.includes('<div class="ai-result-item">') && !formatted.endsWith('</div>')) {
                    formatted += '</div>';
                }
                
                return formatted;
            }
            
            async generateStep2Analysis() {
                // Step2の分析ロジック
                const demographic = document.getElementById('targetDemographic').value;
                const psychographic = document.getElementById('targetPsychographic').value;
                const depth = document.getElementById('targetDepth').value;
                
                if (!demographic || !psychographic || !depth) {
                    this.showToast('すべての項目を入力してください', 'error');
                    return;
                }
                
                document.getElementById('loading2').classList.add('active');
                
                const prompt = `
                    以下のターゲット情報から、詳細なペルソナを作成してください。
                    
                    デモグラフィック: ${demographic}
                    サイコグラフィック: ${psychographic}
                    欲求深度: ${depth}
                    
                    以下の形式で回答してください：
                    1. ペルソナプロフィール（名前、年齢、職業、家族構成など）
                    2. 1日のタイムスケジュール
                    3. 価値観と優先順位
                    4. 購買行動の特徴
                `;
                
                try {
                    const result = await this.callGeminiAPI(prompt);
                    this.displayStep2Result(result);
                } catch (error) {
                    const fallbackResult = this.getFallbackStep2Result();
                    this.displayStep2Result(fallbackResult);
                } finally {
                    document.getElementById('loading2').classList.remove('active');
                }
            }
            
            getFallbackStep2Result() {
                return `
1. ペルソナプロフィール
名前：佐藤 由香里（35歳）
職業：IT企業マーケティング部課長
家族：夫（38歳・メーカー勤務）、長女（7歳）、長男（4歳）
居住地：東京都世田谷区（3LDKマンション）

2. 1日のタイムスケジュール
06:00 起床・朝食準備
07:00 子供を保育園へ
08:30 出社
18:30 退社・買い物
19:30 夕食準備
21:00 子供の寝かしつけ
22:00 家事・自分時間

3. 価値観と優先順位
1位：家族の健康と幸せ
2位：仕事での成果とキャリア
3位：効率的な時間活用
4位：自己成長と学習

4. 購買行動の特徴
・オンラインでの情報収集を重視
・口コミや評価を必ずチェック
・初期投資より長期的なコスパを重視
・ブランドより実用性を優先
                `;
            }
            
            displayStep2Result(result) {
                const resultContainer = document.getElementById('step2Result');
                resultContainer.innerHTML = `
                    <div class="ai-result">
                        <div class="ai-result-header">
                            <span class="ai-badge">AI分析完了</span>
                            <span class="ai-result-title">ターゲットペルソナ</span>
                        </div>
                        <div class="ai-result-content">
                            ${this.formatAIResponse(result)}
                        </div>
                    </div>
                `;
                this.showToast('ターゲット分析が完了しました', 'success');
            }
            
            nextStep() {
                if (this.currentStep < this.totalSteps) {
                    this.currentStep++;
                    this.goToStep(this.currentStep);
                }
            }
            
            previousStep() {
                if (this.currentStep > 1) {
                    this.currentStep--;
                    this.goToStep(this.currentStep);
                }
            }
            
            goToStep(step) {
                this.currentStep = step;
                
                // サイドバーの更新
                document.querySelectorAll('.step-item').forEach((item, index) => {
                    const itemStep = index + 1;
                    item.classList.remove('active');
                    if (itemStep < step) {
                        item.classList.add('completed');
                    } else if (itemStep === step) {
                        item.classList.add('active');
                        item.classList.remove('completed');
                    } else {
                        item.classList.remove('completed');
                    }
                });
                
                // コンテンツの読み込み
                this.loadStepContent(step);
            }
            
            loadStepContent(step) {
                const mainContent = document.getElementById('mainContent');
                
                // 各ステップのコンテンツを動的に生成
                const stepContents = {
                    2: this.getStep2Content(),
                    3: this.getStep3Content(),
                    4: this.getStep4Content(),
                    5: this.getStep5Content()
                };
                
                if (step > 1 && stepContents[step]) {
                    mainContent.innerHTML = stepContents[step];
                }
            }
            
            getStep2Content() {
                return `
                    <div class="step-container" id="step2">
                        <div class="step-header">
                            <span class="step-number">
                                <span>STEP 2</span>
                            </span>
                            <h2 class="step-title">ターゲットの理解</h2>
                            <p class="step-subtitle">商品価値を最も喜んでくれる人を見つけましょう</p>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">メインターゲット層</label>
                            <div class="form-helper">年齢、性別、職業などの基本属性</div>
                            <input type="text" class="form-input" id="targetDemographic" placeholder="例：30-40代の共働き主婦">
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">ライフスタイル・価値観</label>
                            <div class="form-helper">趣味、関心事、生活パターンなど</div>
                            <textarea class="form-textarea" id="targetPsychographic" placeholder="例：&#10;・仕事と家事の両立で忙しい&#10;・効率的な家事を重視&#10;・家族の健康を大切にしている"></textarea>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">欲求の深度</label>
                            <select class="form-select" id="targetDepth">
                                <option value="">選択してください</option>
                                <option value="latent">潜在層 - 課題に気づいていない</option>
                                <option value="semi-aware">準顕在層 - 課題は認識しているが行動していない</option>
                                <option value="aware">顕在層 - 積極的に解決策を探している</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-primary" onclick="app.generateStep2Analysis()">
                            <span>✨</span>
                            <span>ペルソナ分析を実行</span>
                        </button>
                        
                        <div class="loading" id="loading2">
                            <div class="spinner"></div>
                            <p>ターゲットペルソナを分析中...</p>
                        </div>
                        
                        <div id="step2Result"></div>
                        
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="app.previousStep()">
                                <span>←</span>
                                <span>前のステップ</span>
                            </button>
                            <button class="btn btn-primary" onclick="app.nextStep()">
                                <span>次のステップへ</span>
                                <span>→</span>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            getStep3Content() {
                return `
                    <div class="step-container" id="step3">
                        <div class="step-header">
                            <span class="step-number">
                                <span>STEP 3</span>
                            </span>
                            <h2 class="step-title">インサイトの理解</h2>
                            <p class="step-subtitle">ターゲットの本音を見抜きましょう</p>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">ペイン（なくしたい悩み）</label>
                            <div class="form-helper">表面的な不満の奥にある本質的な課題</div>
                            <textarea class="form-textarea" id="targetPain" placeholder="例：&#10;・掃除に時間を取られて家族との時間が減っている&#10;・本当に清潔にできているか不安&#10;・掃除用品の管理が煩雑"></textarea>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">ゲイン（得たい価値）</label>
                            <div class="form-helper">理想の未来像</div>
                            <textarea class="form-textarea" id="targetGain" placeholder="例：&#10;・家族との時間を大切にしたい&#10;・清潔で健康的な住環境を維持したい&#10;・効率的でストレスフリーな家事"></textarea>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">障壁（行動を妨げるもの）</label>
                            <div class="form-helper">購入・利用をためらう理由</div>
                            <textarea class="form-textarea" id="targetBarrier" placeholder="例：&#10;・初期費用が高そう&#10;・本当に効果があるか疑問&#10;・使い方が複雑そう"></textarea>
                        </div>
                        
                        <button class="btn btn-primary" onclick="app.generateStep3Analysis()">
                            <span>✨</span>
                            <span>インサイト分析を実行</span>
                        </button>
                        
                        <div class="loading" id="loading3">
                            <div class="spinner"></div>
                            <p>深層インサイトを分析中...</p>
                        </div>
                        
                        <div id="step3Result"></div>
                        
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="app.previousStep()">
                                <span>←</span>
                                <span>前のステップ</span>
                            </button>
                            <button class="btn btn-primary" onclick="app.nextStep()">
                                <span>次のステップへ</span>
                                <span>→</span>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            getStep4Content() {
                return `
                    <div class="step-container" id="step4">
                        <div class="step-header">
                            <span class="step-number">
                                <span>STEP 4</span>
                            </span>
                            <h2 class="step-title">訴求軸の開発</h2>
                            <p class="step-subtitle">心に刺さるメッセージを作りましょう</p>
                        </div>
                        
                        <button class="btn btn-primary" onclick="app.generateStep4Analysis()">
                            <span>✨</span>
                            <span>訴求軸を自動生成</span>
                        </button>
                        
                        <div class="loading" id="loading4">
                            <div class="spinner"></div>
                            <p>最適な訴求軸を開発中...</p>
                        </div>
                        
                        <div id="step4Result"></div>
                        
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="app.previousStep()">
                                <span>←</span>
                                <span>前のステップ</span>
                            </button>
                            <button class="btn btn-primary" onclick="app.nextStep()">
                                <span>次のステップへ</span>
                                <span>→</span>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            getStep5Content() {
                return `
                    <div class="step-container" id="step5">
                        <div class="step-header">
                            <span class="step-number">
                                <span>STEP 5</span>
                            </span>
                            <h2 class="step-title">コミュニケーションコンセプト設計</h2>
                            <p class="step-subtitle">商品の存在意義を一言で表現しましょう</p>
                        </div>
                        
                        <button class="btn btn-primary" onclick="app.generateStep5Analysis()">
                            <span>✨</span>
                            <span>コンセプトを生成</span>
                        </button>
                        
                        <div class="loading" id="loading5">
                            <div class="spinner"></div>
                            <p>コミュニケーションコンセプトを設計中...</p>
                        </div>
                        
                        <div id="step5Result"></div>
                        
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="app.previousStep()">
                                <span>←</span>
                                <span>前のステップ</span>
                            </button>
                            <button class="btn btn-primary" onclick="app.downloadReport()">
                                <span>📥</span>
                                <span>レポートをダウンロード</span>
                            </button>
                        </div>
                    </div>
                `;
            }
            
            showToast(message, type = 'success') {
                const toast = document.getElementById('toast');
                const messageEl = toast.querySelector('.toast-message');
                
                toast.className = `toast ${type}`;
                messageEl.textContent = message;
                
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
            
            downloadReport() {
                // レポートのダウンロード機能
                this.showToast('戦略レポートを生成しています...', 'success');
                
                // 実際の実装では、PDFやExcelファイルを生成
                setTimeout(() => {
                    this.showToast('レポートのダウンロードを開始しました', 'success');
                }, 2000);
            }
        }
        
        // アプリケーションの初期化
        const app = new CreativeStrategyApp();
    </script>
</body>
</html>
